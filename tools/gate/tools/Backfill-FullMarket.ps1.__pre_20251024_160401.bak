if ($env:ALPHACITY_ALLOW -ne '1') { Write-Error 'ALPHACITY_ALLOW=1 not set.' -ErrorAction Stop }
# 從 tools\gate\tools\ 掛回專案根的 fullmarket 實作（兩條候選路徑擇一）
$root = Split-Path (Split-Path $PSScriptRoot -Parent) -Parent   # -> repo root
$cands = @(
  (Join-Path $root 'tools\fullmarket\Backfill-FullMarket.ps1'),
  (Join-Path $root 'tools\Backfill-FullMarket.ps1')
)
$target = $cands | Where-Object { Test-Path $_ } | Select-Object -First 1
if(-not $target){ throw "Bridge target missing: (checked) `n  - $($cands -join "`n  - ")" }
& pwsh -NoProfile -ExecutionPolicy Bypass -File $target @args
